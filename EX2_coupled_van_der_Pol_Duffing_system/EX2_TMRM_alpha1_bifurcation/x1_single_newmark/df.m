function y = df(x1, x2, M, k11, k12, k21, k22)
    % 计算导数
    y = zeros(2, 2);  % 确保 y 是 2x2 矩阵
    
    % 按元素计算导数
    y(1,1) = M(1,1) + 2*k11*x1 + 3*k12*x1^2;  % d/dx1
    y(1,2) = M(1,2);  % d/dx2
    y(2,1) = M(2,1);  % d/dx1
    y(2,2) = M(2,2) + 2*k21*x2 + 3*k22*x2^2;  % d/dx2
end